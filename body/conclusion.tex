%%==================================================
%% conclusion.tex for SJTU Master Thesis
%% based on CASthesis
%% modified by wei.jianwen@gmail.com
%% version: 0.3a
%% Encoding: UTF-8
%% last update: Dec 5th, 2010
%%==================================================

\chapter*{全文总结\markboth{全文总结}{}}
\addcontentsline{toc}{chapter}{全文总结}

人类永远在追逐更高效、便捷、廉价的计算资源。而随着云计算这种新型计算模式的逐渐兴起，系统虚拟化技术广泛受到了工业界和学术界的关注，并在其中扮演着愈来愈关键的角色。

然而，现有系统虚拟化平台上还存在着不少亟待解决的问题。虚拟机内用户隐私数据的安全问题是其中较为突出的一个。在现有虚拟化平台中，虚拟机监控器处于系统最高权限运行，其能够接触到客户虚拟机运行时所有的内存和磁盘数据，并任意访问其中的用户隐私，给云平台上的数据安全造成威胁。除此之外，由于虚拟机监控器和客户虚拟机之间存在语义隔阂，虚拟机监控器做出的盲目调度行为会使得并行应用程序在多虚拟机整合运行情形下的性能严重降低。如何提升虚拟机整合运行时的系统运行效率，是另一个颇有实际意义的研究问题。

本文针对上述虚拟化环境中安全性和性能方面的两个问题，深入剖析了其内在成因，提出并实现了可行的解决方案，完成了Secure KVM和FlexCore这两个原型系统。本文的主要贡献可以概括如下：

\begin{itemize}
\item 基于嵌套式虚拟化实现了Secure KVM系统。通过在原虚拟机监控器KVM下方添加安全嵌套式虚拟化层，Secure KVM将原先占据系统最高权限的KVM调整到非根模式运行，并在嵌套式虚拟化层中监视KVM做出的所有与客户虚拟机相关的操作。Secure KVM在保障了客户虚拟机正常运行的同时，避免其中的用户隐私数据遭到恶意虚拟机监控器窥探，以可以接受的性能开销增强了云环境中的数据安全。
\item 在KVM虚拟化平台上实现了FlexCore，一个虚拟机动态调度系统。FlexCore系统利用vCPU Ballooning这种全新虚拟机调度策略，通过主动减少赋予虚拟机的vCPU数目来避免因多个vCPU竞争物理处理器而造成的性能损耗。该策略的雏形在Apsys'13中被简要描述，而本文在该策略初步构想的基础上，细致剖析了该策略奏效的内在原因，完善了具体的调度算法，并在KVM平台上给出了完整实现。测试结果表明，该调度算法给并行应用程序测试集带来了高达50\%的平均性能提升。
\end{itemize}

科技发展日新月异，学术界近年来在系统虚拟化领域倾注了大量的研究精力，而本文涉及的Secure KVM和FlexCore这两个原型系统亦有相当的提升空间。最后，作者在这里提出若干与本文工作相关的未来展望：

\begin{itemize}
\item \textbf{利用硬件特性提升嵌套式虚拟化性能：}Secure KVM系统现有的嵌套式虚拟化特性完全依赖于L0层的软件实现，此方式不仅实现极其复杂且运行效率较低。其中主要原因在于，VMX非根模式下读写VMCS会产生虚拟化陷入。Intel在其最新发售的处理器中支持影子VMCS（Shadow VMCS）特性，客户虚拟机监控器（L1）可以指定某内存页存放影子VMCS，在该影子VMCS上进行的VMREAD/VMWRITE操作不会引发虚拟化陷入。Secure KVM可以利用该处理器新特性提升嵌套式虚拟化性能。不过，此项改进无法对L1保持透明，需要L1合作配合，能否用于虚拟化安全领域仍有待考虑。
\item \textbf{利用硬件机制解决虚拟化平台安全性问题：}Intel处理器上的可信任执行技术（Intel TXT），已具备从硬件层面防护隔离指定内存的能力，可确保在处理器上运行的高权限程序具备更强的抗攻击能力。该特性现有的应用范例，仅限于保护裸机上操作系统和虚拟机监控器免受外界攻击。Intel今后如果扩展TXT的保护功能，使之可被用于保护虚拟机用户数据隐私性，则从硬件层面提供了解决问题的新途径，对此我们拭目以待。
\item \textbf{结合半虚拟化，打破虚拟化语义隔阂：}传统操作系统中的很多机制其实与系统虚拟化格格不入，阻碍虚拟机性能提升，如精确时钟获取、核间广播IPI。从性能角度出发，其实完全没有必要向客户虚拟机隐瞒虚拟化层的存在。通过结合半虚拟化思想，在虚拟机监控器和虚拟机之间建立必要的沟通共享，打破语义隔阂，有利于系统整体性能提升。事实上，Linux已经再朝此方面努力，在探测到自身作为虚拟机运行后Linux会做出一些自适应优化，如启用PV-Clock、PV-Spinlock。一些研究者甚至考虑从头开始设计一个适合在虚拟化环境中运行的客户操作系统，如发表于Usenix ATC'14的OSv\cite{osv}。将半虚拟化和普通硬件辅助虚拟化相结合，往往能取得较大的性能优势。
\end{itemize}

全文完。




